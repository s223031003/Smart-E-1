@using Microsoft.AspNetCore.Identity
@using Microsoft.AspNetCore.Mvc.Localization
@using Microsoft.AspNetCore.Mvc.TagHelpers
@{
    ViewData["Title"] = "Home Page";
    Layout = "_Layout";
}
@inject IViewLocalizer _localizer
@inject UserManager<ApplicationUser> _userManager
@model ParentViewModel
<head>
    <title>Parent Dashboard</title>
    <link href="~/assets/libs/magnific-popup/dist/magnific-popup.css" rel="stylesheet">
    <link href="~/assets/libs/datatables.net-bs4/css/dataTables.bootstrap4.css" rel="stylesheet">
    <link href="~/assets/libs/footable/css/footable.core.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="~/assets/libs/select2/dist/css/select2.min.css">
    <link href="~/assets/libs/sweetalert2/dist/sweetalert2.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/dropzone/5.4.0/min/dropzone.min.css"/>
    <link rel="stylesheet" type="text/css" href="~/assets/libs/bootstrap-switch/dist/css/bootstrap3/bootstrap-switch.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g==" crossorigin="anonymous" referrerpolicy="no-referrer" />


</head>
<body>
<main>
    <div class="container-fluid">
        <div class="page-breadcrumb"> 
            <div class="row">
                <div class="col-5 align-self-center">
                    <h3 class="page-title" style="color:#662d91">@_localizer["PARENT DASHBOARD"]</h3>
                    <div class="d-flex align-items-center">
                    </div>
                </div>
            </div>
        </div>
        <div class="row"></div>
        <div class="row">
            <div class="col-md-3">
                <div class="card bg-outline-primary" style="max-width: 18rem; ">
                    <div class="card-header">Number of Children
                        <i class="fa fa-user-circle" aria-hidden="true"></i>
                    </div>
                    <div class="card-body">  
                        <h3 class="card-title">@ViewBag.TotalChildren</h3>
                      
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card bg-outline-secondary" style="max-width: 18rem;">
                    <div class="card-header">Number of Invites
                        <i class="fas fa-book" aria-hidden="true"></i>
                    </div>
                    <div class="card-body">
                        <button type="button" onclick="javascript:openInvites();" class="btn btn-outline-info waves-effect waves-light align-content-end float-lg-right"><i class="fa fa-envelope"><span> </span></i></button><h3>@ViewBag.TotalInvites</h3>

                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card bg-outline-success" style="max-width: 18rem;">
                    <div class="card-header">Unread Messages
                        <i class="fa fa-facebook-messenger" aria-hidden="true"></i>
                    </div>
                    <div class="card-body">
                        <button type="button" onclick="javascript:openTeacherMessages();" class="btn btn-outline-info waves-effect waves-light align-content-end float-lg-right"><i class="fa fa-comments"><span> </span></i></button><h3>@ViewBag.TotalChats</h3>

                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card bg-outline-warning" style="max-width: 18rem;">
                    <div class="card-header">Progress Report
                        <i class="sl-icon-pie-chart" aria-hidden="true"></i>
                    </div>
                    <div class="card-body">
                        <button type="button" onclick="    progressReport();" class="btn btn-outline-info waves-effect waves-light align-content-end"><i class="fa fa-chart-bar"><span> Click here...</span></i></button>

                    </div>
                </div>
            </div>
        </div>
    
        
        <br/>
        <div class="row">
            <div class="col">
                <div class="card" style="border-block-color: #2B3856; max-width: 45rem; margin: 15px; box-shadow: 0 4px 8px 0, 0 6px 20px 0">
                    <div class="row">
                        <div class="col-12">
                            <div class="card-header">
                                <div class="row">
                                    <h4 style="color: #662d91">MY CHILDREN</h4>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table id="tblChildren" class="table v-middle">
                                        <thead>
                                        <tr>
                                            <th style="color: black">@_localizer["Name"]</th>
                                            <th style="width: 50px"></th>
                                        </tr>
                                        </thead>
                                        <tbody>

                                        <tfoot>
                                        <tr>
                                            <th style="color: black">@_localizer["Name"]</th>
                                            <th></th>

                                        </tr>
                                        </tfoot>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col">
                <div class="card" style="border-block-color: #2B3856; max-width: 45rem; margin: 15px; box-shadow: 0 4px 8px 0, 0 6px 20px 0">
                    <div class="row">
                        <div class="col-12">
                            <div class="card-header">
                                <div class="row">
                                    <h4 style="color: #662d91">Upcoming Assignments</h4>
                                </div>
                            </div>
                        </div>

                            <div class="card-body">
                                <div class="table-responsive">
                                    <table id="tblUpcomingAssignments" class="table v-middle" style="width: 100%">
                                        <thead>
                                        <tr>
                                            <th style="width: 160px; color: black">@_localizer["Date"]</th>
                                            <th style="color: black">@_localizer["Subject"]</th>
                                            <th style="width: 160px;color: black">@_localizer["Assignment"]</th>
                                            <th style="width: 160px; color: black">@_localizer["Child Name"]</th>
                                        </tr>
                                        </thead>
                                        <tbody>

                                        <tfoot>
                                        <tr>
                                            <th style="color: black">@_localizer["Date"]</th>
                                            <th style="color: black">@_localizer["Subject"]</th>
                                            <th style="color: black">@_localizer["Assignment"]</th>
                                            <th style="color: black">@_localizer["Child Name"]</th>

                                        </tr>
                                        </tfoot>

                                        </tbody>

                                    </table>
                                </div>
                            </div>
                    </div>

                </div>
            </div>


        </div>
    </div>



</main>

<style>
    /* Slider */
    .slick-slide {
        margin: 0px 20px;
    }
    .slick-slide img {
        width: 100%;
    }
    .slick-slider {
        position: relative;
        display: block;
        box-sizing: border-box;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        -webkit-touch-callout: none;
        -khtml-user-select: none;
        -ms-touch-action: pan-y;
        touch-action: pan-y;
        -webkit-tap-highlight-color: transparent;
    }
    .slick-list {
        position: relative;

        display: block;
        overflow: hidden;

        margin: 0;
        padding: 0;
    }
    .slick-list:focus {
        outline: none;
    }
    .slick-list.dragging {
        cursor: pointer;
        cursor: hand;
    }
    .slick-slider .slick-track,
    .slick-slider .slick-list {
        -webkit-transform: translate3d(0, 0, 0);
        -moz-transform: translate3d(0, 0, 0);
        -ms-transform: translate3d(0, 0, 0);
        -o-transform: translate3d(0, 0, 0);
        transform: translate3d(0, 0, 0);
    }
    .slick-track {
        position: relative;
        top: 0;
        left: 0;

        display: block;
    }
    .slick-track:before,
    .slick-track:after {
        display: table;

        content: '';
    }
    .slick-track:after {
        clear: both;
    }
    .slick-loading .slick-track {
        visibility: hidden;
    }
    .slick-slide {
        display: none;
        float: left;

        height: 100%;
        min-height: 1px;
    }
    [dir='rtl'] .slick-slide {
        float: right;
    }
    .slick-slide img {
        display: block;
    }
    .slick-slide.slick-loading img {
        display: none;
    }
    .slick-slide.dragging img {
        pointer-events: none;
    }
    .slick-initialized .slick-slide {
        display: block;
    }
    .slick-loading .slick-slide {
        visibility: hidden;
    }
    .slick-vertical .slick-slide {
        display: block;
        height: auto;
        border: 1px solid transparent;
    }
    .slick-arrow.slick-hidden {
        display: none;
    }
    .slick-arrow {
        background: #fff;
        padding: 0;
        border: none;
    }
    .slick-arrow img {
        opacity: 0.4;
    }
    .slick-arrow img:hover {
        opacity: 1.0;
    }

    /* News Styling */
    .news-slider {
        padding: 40px 0;
    }
    .blogPost--small {
        color: #7c7b7b;
        margin: 20px 30px 40px 0;
    }
    .blogPost--small .media > .pull-left {
        margin-right: 25px;
    }
    .blogPost--small a {
        color: #662d91;
    }
    .blogPost--small .date, .blogPost--small .dateEl2 {
        display: block;
        text-align: center;
        padding: 10px;
        color: #fff;
        background: #662d91;
    }
    .blogPost--small .date span, .blogPost--small .dateEl2 span {
        display: inline-block;
        font-size: 42px;
        line-height: 1;
        letter-spacing: 0em;
        text-indent: -0.1em;
        color: #fff;
        font-weight: bold;
    }
    .blogPost--small .date small, .blogPost--small .dateEl2 small {
        display: block;
        font-size: 18px;
        text-transform: uppercase;
        color: #fff;
    }
    .blogPost--small h4 {
        margin: 0 0 12px 0;
        font-size: 22px;
        text-transform: uppercase;
    }
    .newsNav .row {
        margin: 0 0;
    }
    .footer {
        left: 0;
        bottom: 0;
        width: 100%;
        background-color: #CBD9DA;
        color: white;
        text-align: center;
        padding: 20px 40px;
    }

    div.container-footer.w-container {
        box-sizing: border-box;
        margin-left: auto;
        margin-right: auto;
        max-width: 940px;
        padding-bottom: 40px;
        padding-top: 70px;
    }

    div.container-footer.w-container:after {
        clear: both;
        content: " ";
        display: table;
        grid-column-end: 2;
        grid-column-start: 1;
        grid-row-end: 2;
        grid-row-start: 1;
    }

    div.container-footer.w-container:before {
        content: " ";
        display: table;
        grid-column-end: 2;
        grid-column-start: 1;
        grid-row-end: 2;
        grid-row-start: 1;
    }

    div.w-row {
        box-sizing: border-box;
        margin-left: -10px;
        margin-right: -10px;
    }

    div.w-row:after {
        clear: both;
        content: " ";
        display: table;
        grid-column-end: 2;
        grid-column-start: 1;
        grid-row-end: 2;
        grid-row-start: 1;
    }

    div.w-row:before {
        content: " ";
        display: table;
        grid-column-end: 2;
        grid-column-start: 1;
        grid-row-end: 2;
        grid-row-start: 1;
    }

    div.footer-column.w-clearfix.w-col.w-col-4 {
        box-sizing: border-box;
        float: left;
        min-height: 1px;
        padding-left: 10px;
        padding-right: 10px;
        position: relative;
        width: 33.3333%;
    }

    div.footer-column.w-clearfix.w-col.w-col-4:after {
        clear: both;
        content: " ";
        display: table;
        grid-column-end: 2;
        grid-column-start: 1;
        grid-row-end: 2;
        grid-row-start: 1;
    }

    div.footer-column.w-clearfix.w-col.w-col-4:before {
        content: " ";
        display: table;
        grid-column-end: 2;
        grid-column-start: 1;
        grid-row-end: 2;
        grid-row-start: 1;
    }

    img.failory-logo-image {
        border-width: 0;
        box-sizing: border-box;
        display: inline-block;
        float: left;
        max-width: 100%;
        vertical-align: middle;
    }

    h3.footer-failory-name {
        box-sizing: border-box;
        color: #ffffff;
        display: block;
        font-family: Lato, sans-serif;
        font-size: 20px;
        font-weight: 900;
        line-height: 1.1em;
        margin-bottom: 10px;
        margin-left: 10px;
        margin-top: 24px;
    }

    p.footer-description-failory {
        box-sizing: border-box;
        color: rgba(255, 255, 255, 0.8);
        display: block;
        font-family: Lato, sans-serif;
        font-size: 17px;
        font-weight: 300;
        letter-spacing: 0.5px;
        line-height: 1.5em;
        margin-bottom: 16px;
        margin-top: 15px;
    }

    br {
        box-sizing: border-box;
    }

    div.footer-column.w-col.w-col-8 {
        box-sizing: border-box;
        float: left;
        min-height: 1px;
        padding-left: 10px;
        padding-right: 10px;
        position: relative;
        width: 66.6667%;
    }

    div.w-col.w-col-8 {
        box-sizing: border-box;
        float: left;
        min-height: 1px;
        padding-left: 0;
        padding-right: 0;
        position: relative;
        width: 66.6667%;
    }

    div.w-col.w-col-7.w-col-small-6.w-col-tiny-7 {
        box-sizing: border-box;
        float: left;
        min-height: 1px;
        padding-left: 0;
        padding-right: 0;
        position: relative;
        width: 58.3333%;
    }

    h3.footer-titles {
        box-sizing: border-box;
        color: #ffffff;
        display: block;
        font-family: Lato, sans-serif;
        font-size: 20px;
        font-weight: 900;
        line-height: 1.1em;
        margin-bottom: 0;
        margin-left: 0;
        margin-top: 24px;
    }

    p.footer-links {
        box-sizing: border-box;
        color: rgba(255, 255, 255, 0.8);
        display: block;
        font-family: Lato, sans-serif;
        font-size: 17px;
        font-weight: 300;
        letter-spacing: 0.5px;
        line-height: 1.8em;
        margin-bottom: 16px;
        margin-top: 2px;
    }

    a {
        background-color: transparent;
        box-sizing: border-box;
        color: #ffffff;
        font-family: Lato, sans-serif;
        font-size: 17px;
        font-weight: 400;
        line-height: 1.2em;
        text-decoration: none;
    }

    a:active {
        outline: 0;
    }

    a:hover {
        outline: 0;
    }

    span.footer-link {
        box-sizing: border-box;
        color: rgba(255, 255, 255, 0.8);
        font-weight: 300;
    }

    span.footer-link:hover {
        color: #ffffff;
        font-weight: 400;
    }

    span {
        box-sizing: border-box;
    }

    strong {
        box-sizing: border-box;
        font-weight: 700;
    }

    div.w-col.w-col-5.w-col-small-6.w-col-tiny-5 {
        box-sizing: border-box;
        float: left;
        min-height: 1px;
        padding-left: 0;
        padding-right: 0;
        position: relative;
        width: 41.6667%;
    }

    div.column-center-mobile.w-col.w-col-4 {
        box-sizing: border-box;
        float: left;
        min-height: 1px;
        padding-left: 0;
        padding-right: 0;
        position: relative;
        width: 33.3333%;
    }

    a.footer-social-network-icons.w-inline-block {
        background-color: transparent;
        box-sizing: border-box;
        color: #ffffff;
        display: inline-block;
        font-family: Lato, sans-serif;
        font-size: 17px;
        font-weight: 400;
        line-height: 1.2em;
        margin-right: 8px;
        margin-top: 10px;
        max-width: 100%;
        opacity: 0.8;
        text-decoration: none;
    }

    a.footer-social-network-icons.w-inline-block:active {
        outline: 0;
    }

    a.footer-social-network-icons.w-inline-block:hover {
        opacity: 1;
        outline: 0;
    }

    img {
        border-width: 0;
        box-sizing: border-box;
        display: inline-block;
        max-width: 100%;
        vertical-align: middle;
    }

    p.footer-description {
        box-sizing: border-box;
        color: rgba(255, 255, 255, 0.8);
        display: block;
        font-family: Lato, sans-serif;
        font-size: 17px;
        font-weight: 300;
        letter-spacing: 0.5px;
        line-height: 1.5em;
        margin-bottom: 16px;
        margin-top: 15px;
    }

    strong.link-email-footer {
        box-sizing: border-box;
        font-weight: 700;
    }
</style>

<div class="footer">
    <div class="w-row">
        <div class="w-row">
        <a asp-controller="Home" asp-action="Index"><strong>GENERAL INFORMATION</strong></a>
            <span class="footer-link"></span>
            </div>

        <div class="w-col w-col-8">
            <div class="w-row">
                <div class="w-col w-col-5 w-col-small-6 w-col-tiny-5">
                    <strong>CONTACT US</strong>
                    <p class="footer-links">
                        <span class="footer-link"><i class="fa fa-envelope" aria-hidden="true"></i>&nbsp; <a href="mailto:s221496688@mandela.ac.za">Admin</a><br></span>
                        <span class="footer-link"><i class="fa fa-phone" aria-hidden="true"></i>&nbsp;<a href="tel:+27 68 220 3226">+27 68 220 3226</a></span>
                    </p>
                </div>
            </div>
        </div>
        <div class="w-row">

        <a asp-controller="Home" asp-action="Privacy"><strong>PRIVACY POLICY</strong></a>
            <span class="footer-link"></span>
            </div>
    </div>
</div>
</body>
<div>
    <script src="~/assets/libs/moment/moment.js"></script>
    <script src="~/assets/libs/bootstrap-material-datetimepicker/js/bootstrap-material-datetimepicker-custom.js"></script>
    <script src="~/assets/extra-libs/DataTables/datatables.min.js"></script>
    <script src="~/dist/js/pages/datatable/datatable-basic.init.js"></script>
    <script src="~/assets/libs/select2/dist/js/select2.full.min.js"></script>
    <script src="~/assets/libs/select2/dist/js/select2.min.js"></script>
    <script src="~/dist/js/pages/forms/select2/select2.init.js"></script>
    <script src="~/assets/libs/sweetalert2/dist/sweetalert2.all.min.js"></script>
    <script src="~/assets/libs/sweetalert2/sweet-alert.init.js"></script>
    <script src="~/assets/libs/moment/moment.js"></script>
    <script src="~/assets/libs/bootstrap-datepicker/dist/js/bootstrap-datepicker.min.js"></script>
    <script src="https://smtpjs.com/v3/smtp.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
</div>

<div id="current-invites-modal" class="modal fade" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none; min-width: calc(100vw - 200px);  min-height: calc(100vh - 200px);">
    <div class="modal-dialog" style="min-width: calc(100vw - 200px);  min-height: calc(100vh - 200px);">
        <div class="modal-content" style="min-width: calc(100vw - 200px);  min-height: calc(100vh - 200px);">
            <div class="modal-header">
                <h4 class="modal-title">My Active Invites</h4>
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-12 col-lg-12">
                        <div class="form-group">
                            <div class="table-responsive">
                                <table id="tblMyInvites" class="table v-middle">
                                    <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Date</th>
                                        <th></th>
                                    </tr>
                                    </thead>
                                    <tfoot>
                                    <tr>
                                        <th>Name</th>
                                        <th>Date</th>
                                        <th></th>
                                    </tr>
                                    </tfoot>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="current-message-modal" class="modal fade" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none; min-width: calc(100vw - 200px);  min-height: calc(100vh - 200px);">
    <div class="modal-dialog" style="min-width: calc(100vw - 200px);  min-height: calc(100vh - 200px);">
        <div class="modal-content" style="min-width: calc(100vw - 200px);  min-height: calc(100vh - 200px);">
            <div class="modal-header">
                <h4 class="modal-title">Teacher Reply</h4>
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
            </div>
            <div class="modal-body">
                <div class="card-body">
                    <div class="form-group">
                        <label class="text-right control-label" for="txtTeacher">Teacher Name</label>
                        <input autocomplete="off" required="required"id="txtTeacher" class="form-control" type="text" readonly="readonly"/>
                    </div>
                    <div class="form-group">
                        <label class="text-right control-label" for="txtMessage">Message</label>
                        <textarea class="form-control"cols="15"id="txtMessage" placeholder="Message..." readonly="readonly" rows="20"></textarea>
                    </div>

                    <input id="txtReadMessageId" hidden="hidden"/>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline-info waves-effect float-lg-right" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-sm btn-outline-info waves-effect waves-light align-content-end float-lg-right" onclick="readMessage()" style="margin-right: 3px" data-toggle="tooltip" data-original-title="Read"><span><i class="fas fa-check" aria-hidden="true"></i> Read</span></button>
            </div>

        </div>
    </div>
</div>


<div id="current-teacher-messages-modal" class="modal fade" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none; min-width: calc(100vw - 200px);  min-height: calc(100vh - 200px);">
        <div class="modal-dialog" style="min-width: calc(100vw - 200px);  min-height: calc(100vh - 200px);">
            <div class="modal-content" style="min-width: calc(100vw - 200px);  min-height: calc(100vh - 200px);">
                <div class="modal-header">
                    <h4 class="modal-title">Unread Messages</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-12 col-lg-12">
                            <div class="form-group">
                                <div class="table-responsive">
                                    <table id="tblTeacherMessages" class="table v-middle">
                                        <thead>
                                            <tr>
                                                <th>Name</th>
                                                <th>Date</th>
                                                <th></th>
                                            </tr>
                                        </thead>
                                        <tfoot>
                                            <tr>
                                                <th>Name</th>
                                                <th>Date</th>
                                                <th></th>
                                            </tr>
                                        </tfoot>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
<script>
function progressReport()
{
    window.location.href = `@Url.Action("MyChild", "MyChild")`;

}
 var tblChildren = $('#tblChildren').DataTable({
        createdRow: function(row, data, dataIndex) {
            $(row).attr('id', data.id);
        },
        "columns": [
            { "data": "name" },
            { "data": "buttons" }
           
        ]
    });
    var groupColumn = 3;
    var dateColumn = 0;
    var tblUpcomingAssignments = $('#tblUpcomingAssignments').DataTable({
        createdRow: function(row, data, dataIndex) {
            $(row).attr('id', data.id);
        },
        "columns": [
            { "data": "date" }, 
            { "data": "subject" },     
            { "data": "name" },     
            { "data": "childName" },     

        ],
        columnDefs: [   { visible: false, targets: [groupColumn] }   ],
        order: [[ groupColumn, 'asc'], [ dateColumn, 'asc']],
        displayLength: 4,
        drawCallback: function ( settings ) {
            var api = this.api();
            var rows = api.rows( {page:'current'}).nodes();
            var last=null;
            api.column(groupColumn, {page:'current'}).data().each( function (group,i){
                if ( last !== group) {
                    $(rows).eq( i ).before(
                        '<tr class="group" style="background-color:grey;color:white" ><td colspan="8"><b>'
                        +group+'</b></td></tr>'
                    );
                    last = group;
                }
            });
        },
        Buttons: [
            { extend: 'collection',
                text: 'Export',
                buttons: [ 'copy', 'excel', 'csv', 'pdf', 'print']
            }
        ]
    });
    
    
     // Order by the grouping
    $('#tblUpcomingAssignments tbody').on( 'click', 'tr.group', function () {
        var currentOrder = table.order()[0];
        if ( currentOrder[0] === groupColumn && currentOrder[1] === 'asc' ) {
            table.order( [ groupColumn, 'desc' ] ).draw();
        }
        else {
            table.order( [ groupColumn, 'asc' ] ).draw();
        }
    } );

     $(document).ready(function() {
        
         loadChildren();
         loadUpcomingAssignments();
    });
    
    function readMessage(){
        $.ajax({
            url: `@Url.Action("UpdateMessageToRead", "MyForums")?id=`+ $('#txtReadMessageId').val(),
            type: 'POST',
            success: function(result) {                                       
                $('#current-message-modal').modal('hide');
                toastr.success('One less message to read', 'Succesful!');

            },
            error: function(jqXHR, exception) {
                swal({
                    title: "ERROR STATUS " + jqXHR.status,
                    text: "Error Message: " + jqXHR.responseText,
                    type: "error",
                     showCancelButton: false,
                    confirmButtonText: "OK"
                });
            }
        });
    
    }
    
    
    
    function loadUpcomingAssignments()
    {
         $.ajax({
            url: '@Url.Action("UpcomingAssignments", "Assignments")',
            type: 'GET',
            success: function(result) {

                var rows = [];

                for (var i = 0; i < result.length; i++) {

                    rows.push({
                        id: result[i].id,
                        date: result[i].date,
                        subject:result[i].subject,
                        name: result[i].name,
                        childName: result[i].childName
                       
                    });

                }

                tblUpcomingAssignments.rows.add(rows).draw();

            },
            error: function(jqXHR, exception) {
                swal({
                    title: "ERROR STATUS " + jqXHR.status,
                    text: "Error Message: " + jqXHR.responseText,
                    type: "error",
                    showCancelButton: false,
                    confirmButtonText: "OK"
                });
            }
        });
    
    }
    function onViewClicked(id){
         $.ajax({
            url: `@Url.Action("MyChildsProgress", "MyChild")?id=${id}`,
            type: 'GET',
            success: function(result) {
                window.location.href = `@Url.Action("MyChildsProgress", "MyChild")?id=${id}`;
            },
            error: function(jqXHR, exception) {
                swal({
                    title: "ERROR STATUS " + jqXHR.status,
                    text: "Error Message: " + jqXHR.responseText,
                    type: "error",
                    showCancelButton: false,
                    confirmButtonText: "OK"
                });
            }
        });    
    
    }
    function deleteChild(id){
        swal({
            title: "CONFIRM",
            text: "Are you sure that you want to unlink this child?",
            type: "warning",
            showCancelButton: true,
            confirmButtonColor: "#DD6B55",
            confirmButtonText: "Yes, remove child!"
        }).then((ok) => {

            if (JSON.stringify(ok) === '{"value":true}') {
                $.ajax({
                    url: `@Url.Action("DeleteChild", "MyChild")?id=${id}`,
                    type: 'DELETE',
                    success: function(result) {

                        toastr.success('Success', 'Child has been removed');
                        
                        location.reload();


                    },
                    error: function(jqXHR, exception) {
                        swal({
                            type: "error",
                            title: "ERROR STATUS " + jqXHR.status,
                            text: "Error Message: " + jqXHR.responseText,
                            showCancelButton: false,
                            confirmButtonText: "OK"
                        });
                    }
                });
            }

        });
    
    
    }
    function loadChildren() {
        $.ajax({
            url: '@Url.Action("GetChildren", "AllUsers")',
            type: 'GET',
            success: function(result) {

                var rows = [];

                for (var i = 0; i < result.length; i++) {

                    rows.push({
                        id: result[i].id,
                        name: result[i].name,
                         buttons: `<div><button type="button" class="btn btn-sm btn-outline-info waves-effect waves-light align-content-end float-lg-right"
                                 onclick="onViewClicked('${result[i].id}')"
                                 style="margin-right: 3px" data-toggle="tooltip" data-original-title="View">
                                 <span><i class="fas fa-search" aria-hidden="true"></i> View</span>
                                 </button>
                                 <button type="button" class="btn btn-sm btn-outline-warning waves-effect waves-light align-content-end float-lg-right"
                                 onclick="deleteChild('${result[i].id}')"
                                 style="margin-right: 3px" data-toggle="tooltip" data-original-title="View">
                                 <span><i class="fas fa-link" aria-hidden="true"></i> Unlink</span>
                                 </button></div>`
                       
                    });

                }

                tblChildren.rows.add(rows).draw();

            },
            error: function(jqXHR, exception) {
                swal({
                    title: "ERROR STATUS " + jqXHR.status,
                    text: "Error Message: " + jqXHR.responseText,
                    type: "error",
                    showCancelButton: false,
                    confirmButtonText: "OK"
                });
            }
        });
    }

     var tblMyInvites = $('#tblMyInvites').DataTable({
        createdRow: function(row, data, dataIndex) {
            $(row).attr('id', data.id);
        },
        "columns": [
            { "data": "name" },
            { "data": "date" },
            { "data": "buttons" }
        ]
    });
     var tblTeacherMessages = $('#tblTeacherMessages').DataTable({
        createdRow: function(row, data, dataIndex) {
            $(row).attr('id', data.id);
        },
        "columns": [
            { "data": "name" },
            { "data": "date" },
            { "data": "buttons" }
        ]
    });
    function acceptInvite(id)
    {
        $.ajax({
            url: `@Url.Action("UpdateParentInvite", "Invites")?id=${id}`,
            type: 'POST',
            success: function(result) {

               tblMyInvites.row(`#${result.id}`).remove().draw(true);
                    
               $('#current-invites-modal').modal('hide');
               
                toastr.success('You can see your child`s progress!', 'Successful');
                
            },
            error: function(jqXHR, exception) {
                Swal.fire({
                    title: "ERROR STATUS " + jqXHR.status,
                    text: "Error Message: " + jqXHR.responseText,
                    type: "error",
                    showCancelButton: false,
                    confirmButtonText: "OK"
                });
            }
        });
    
    
    }
    
    function declineInvite(id)
    {
        $.ajax({
            url: `@Url.Action("DeleteParentInvite", "Invites")?id=${id}`,
            type: 'POST',
            success: function(result) {

               tblMyInvites.row(`#${result.id}`).remove().draw(true);
                    
               $('#current-invites-modal').modal('hide');
                
            },
            error: function(jqXHR, exception) {
                Swal.fire({
                    title: "ERROR STATUS " + jqXHR.status,
                    text: "Error Message: " + jqXHR.responseText,
                    type: "error",
                    showCancelButton: false,
                    confirmButtonText: "OK"
                });
            }
        });

        
    }
    function openchatHub()
   {
         window.location.href = `@Url.Action("ChatHub", "ChatHub")`;
    }
    
    function onCheckClicked(id){    
         $.ajax({
            url: `@Url.Action("GetTeacherMessage", "MyForums")?id=${id}`,
            type: 'GET',
            success: function(result) {
                $('#txtReadMessageId').val(result.id);
                $('#txtMessage').val(result.message);
                $('#txtTeacher').val(result.teacher);

                $('#current-teacher-messages-modal').modal('hide');

                $('#current-message-modal').modal('show');
            },
            error: function(jqXHR, exception) {
                swal({
                    title: "ERROR STATUS " + jqXHR.status,
                    text: "Error Message: " + jqXHR.responseText,
                    type: "error",
                    showCancelButton: false,
                    confirmButtonText: "OK"
                });
            }
        });
        
    }
    function openTeacherMessages()
   {
        $.ajax({
            url: '@Url.Action("GetParentReplyMessages", "MyForums")',
            type: 'GET',
            success: function(result) {

                tblTeacherMessages.clear().draw();

                if (result.length > 0) {

                    var rows = [];
                    for (var i = 0; i < result.length; i++) {
                        rows.push({
                            id: result[i].id,
                            name: result[i].name,
                            date: result[i].date,
                            buttons: `<div><button type="button" class="btn btn-sm btn-outline-info waves-effect waves-light align-content-end float-lg-right"
                                 onclick="onCheckClicked('${result[i].id}')"
                                 style="margin-right: 3px" data-toggle="tooltip" data-original-title="View">
                                 <span><i class="fas fa-search" aria-hidden="true"></i> View</span>
                                 </button></div>`
                            
                        });
                    }
                    tblTeacherMessages.rows.add(rows).draw();
                    
                    $('#current-teacher-messages-modal').modal('show');
                }
                else{
                     toastr.error('You have no new messages', 'Error!');
                }
            },
            error: function(jqXHR, exception) {
                Swal.fire({
                    title: "ERROR STATUS " + jqXHR.status,
                    text: "Error Message: " + jqXHR.responseText,
                    type: "error",
                    showCancelButton: false,
                    confirmButtonText: "OK"
                });
            }
        });
   
   }
    
   function openInvites()
   {
        $.ajax({
            url: '@Url.Action("GetUserInvites", "Invites")',
            type: 'GET',
            success: function(result) {

                tblMyInvites.clear().draw();

                if (result.length > 0) {

                    var rows = [];
                    for (var i = 0; i < result.length; i++) {
                        rows.push({
                            id: result[i].id,
                            name: result[i].name,
                            date: result[i].date,
                            buttons: `<div><button class="btn btn-sm btn-outline-danger float-right" onclick="javascript:declineInvite('${result[i].id}');" style="margin-left: 3px;">Reject</button>
                                    <button class="btn btn-sm btn-outline-dark float-right" onclick="javascript:acceptInvite('${result[i].id}');" style="margin-left: 3px;">Accept</button>
                                </div>`
                        });
                    }
                    tblMyInvites.rows.add(rows).draw();
                    
                    $('#current-invites-modal').modal('show');
                }
                else{
                     toastr.error('You have no invites', 'Error!');
                }
            },
            error: function(jqXHR, exception) {
                Swal.fire({
                    title: "ERROR STATUS " + jqXHR.status,
                    text: "Error Message: " + jqXHR.responseText,
                    type: "error",
                    showCancelButton: false,
                    confirmButtonText: "OK"
                });
            }
        });
   
   }
   @*
var xValues = ["Geography", "Physical Science", "Life Science"];
var yValues = [65, 59, 76];
var barColors = ["red", "green","blue"];

new Chart("myChart", {
  type: "bar",
  data: {
    labels: xValues,
    datasets: [{
      backgroundColor: barColors,
      data: yValues
    }]
  },
  options: {
    legend: {display: false},
    title: {
      display: true,
      text: "Average progress for this year"
    }
  }
});*@



</script>
